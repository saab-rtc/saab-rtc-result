<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LSC Result Card - RTC Hyderabad</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Times New Roman', serif;
      background: #eee;
      padding: 20px;
    }
    .marksheet {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border: 2px solid #000;
    }
    .centered { text-align: center; }
    .header-title {
      font-size: 18px;
      font-weight: bold;
      text-transform: uppercase;
    }
    .sub-title {
      margin: 5px 0;
      font-size: 15px;
      text-transform: uppercase;
    }
    .badge {
      font-size: 14px;
      background: #eee;
      border: 1px solid #ccc;
      padding: 2px 10px;
      display: inline-block;
      margin-top: 5px;
    }
    .info-table td {
      padding: 5px 10px;
      vertical-align: top;
      font-size: 14px;
    }
    .marks-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    .marks-table th, .marks-table td {
      border: 1px solid #000;
      padding: 6px;
      font-size: 14px;
      text-align: center;
    }
    .footer-info {
      margin-top: 20px;
      font-size: 14px;
    }
    .developer {
      text-align: right;
      font-style: italic;
      font-size: 13px;
      color: #333;
    }
    .btns {
      text-align: center;
      margin-top: 20px;
    }
    .btns button {
      padding: 10px 20px;
      font-size: 14px;
      margin: 0 10px;
      cursor: pointer;
    }
    @media print {
      .btns { display: none; }
    }
  </style>
</head>
<body>

<div class="marksheet" id="marksheet">
  <div class="centered">
    <div class="header-title">SHAHEED ABDUL AZIZ BULLO RECRUIT TRAINING CENTER HYDERABAD</div>
    <div class="sub-title">MARKS CERTIFICATE</div>
    <div class="sub-title">Final Result of Lower School Course Batch 01/2025</div>
  </div>
  <br>
  <table class="info-table">
    <tr>
      <td><strong>Roll / Seat No:</strong> <span id="seatNo">...</span></td>
      <td><strong>Name:</strong> <span id="name">...</span></td>
      <td rowspan="4" style="text-align:center;"><img src="" alt="Photo" width="100" height="120" style="display:none;" id="photo"></td>
    </tr>
    <tr>
      <td><strong>Rank & B.No:</strong> <span id="rank">...</span></td>
      <td><strong>Father's Name:</strong> <span id="father">...</span></td>
    </tr>
    <tr>
      <td><strong>CNIC:</strong> <span id="cnic">...</span></td>
      <td><strong>Arrival Dist / Unit:</strong> <span id="unit">...</span></td>
    </tr>
  </table>

  <table class="marks-table" id="marksTable">
    <thead>
      <tr>
        <th>Subject</th>
        <th>Max Marks</th>
        <th>Obtained</th>
        <th>Remarks</th>
      </tr>
    </thead>
    <tbody>
      <!-- Subjects will be inserted dynamically -->
    </tbody>
    <tfoot>
      <tr>
        <th colspan="2">Total</th>
        <td id="totalObtained">...</td>
        <td id="result">...</td>
      </tr>
      <tr>
        <th colspan="2">Percentage</th>
        <td colspan="2" id="percentage">...</td>
      </tr>
      <tr>
        <th colspan="4" id="inWords">Marks in Words: ...</th>
      </tr>
    </tfoot>
  </table>

  <div class="footer-info">
    <strong>No:</strong> RTC/ESTT/SAB/4879-90/2025<br>
    <strong>Date:</strong> 30/06/2025
    <br><br>
    <strong>(ABRAR MUHAMMAD AWAN) SPS</strong><br>
    DSP / Principal<br>
    SAB, RTC HYDERABAD
  </div>

  <div class="developer">System Developed by Mohsin Ali Jamali</div>
</div>

<div class="btns">
  <button onclick="window.print()"><i class="fas fa-print"></i> Print</button>
  <button onclick="downloadPDF()"><i class="fas fa-file-pdf"></i> Download PDF</button>
</div>

<script>
function fillData(data) {
  document.getElementById('seatNo').textContent = data["ROLL / SEAT NO"];
  document.getElementById('name').textContent = data["NAME"];
  document.getElementById('rank').textContent = data["RANK & B.No"];
  document.getElementById('father').textContent = data["FATHER'S NAME"];
  document.getElementById('cnic').textContent = data["CNIC"];
  document.getElementById('unit').textContent = data["ARRIVAL DIST. /UNIT"];

  const subjects = [
    "Legal Knowledge", "CrPC & Police Rules", "PPW & Forensic Sci",
    "General Knowledge", "Investigation", "Operation", "Security",
    "Intelligence", "Module 01 to 20", "English Language & Professional Skills",
    "Prade & Drill", "Physical & Fitness", "Musketry & Firing",
    "Discipline", "Viva Voce"
  ];
  let tbody = document.querySelector('#marksTable tbody');
  let total = 0;
  subjects.forEach(sub => {
    let marks = parseInt(data[sub]) || 0;
    total += marks;
    let remarks = marks >= 40 ? 'PASS' : 'FAIL';
    tbody.innerHTML += `<tr><td>${sub}</td><td>100</td><td>${marks}</td><td>${remarks}</td></tr>`;
  });
  document.getElementById('totalObtained').textContent = total;
  document.getElementById('result').textContent = data["Result"];
  document.getElementById('percentage').textContent = data["Percentage"] + "%";
  document.getElementById('inWords').textContent = "Marks in Words: " + convertNumberToWords(total).toUpperCase() + " ONLY";
}

function convertNumberToWords(amount) {
  const words = ["Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten",
    "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
  const tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];

  if (amount < 20) return words[amount];
  if (amount < 100) return tens[Math.floor(amount / 10)] + (amount % 10 ? " " + words[amount % 10] : "");
  if (amount < 1000) return words[Math.floor(amount / 100)] + " Hundred" + (amount % 100 ? " and " + convertNumberToWords(amount % 100) : "");
  if (amount < 100000) return convertNumberToWords(Math.floor(amount / 1000)) + " Thousand" + (amount % 1000 ? " " + convertNumberToWords(amount % 1000) : "");
  return amount;
}

function downloadPDF() {
  var element = document.getElementById('marksheet');
  html2pdf().set({ margin: 10, filename: 'ResultCard.pdf', html2canvas: { scale: 2 }, jsPDF: { unit: 'mm', format: 'a4' } }).from(element).save();
}

// --- Dummy Example to test ---
fillData({
  "ROLL / SEAT NO": "LSC/1/25-6",
  "NAME": "Shahzaib Liaquat",
  "RANK & B.No": "PC-1256",
  "FATHER'S NAME": "Liaquat Ali",
  "CNIC": "41301-1882647-9",
  "ARRIVAL DIST. /UNIT": "T.A.YAR",
  "Legal Knowledge": "100",
  "CrPC & Police Rules": "79",
  "PPW & Forensic Sci": "89",
  "General Knowledge": "72",
  "Investigation": "85",
  "Operation": "93",
  "Security": "64",
  "Intelligence": "85",
  "Module 01 to 20": "187",
  "English Language & Professional Skills": "75",
  "Prade & Drill": "91",
  "Physical & Fitness": "82",
  "Musketry & Firing": "76",
  "Discipline": "40",
  "Viva Voce": "38",
  "Result": "PASS",
  "Percentage": "83.7",
});
</script>
</body>
</html>
